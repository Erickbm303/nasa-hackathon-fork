<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Meteor Impact + Earthquake & Tsunami Interface</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="sidebar">
    <h2>Meteor Impact Simulator</h2>
    <div class="sub">NEOs → simulate impact → draw crater & tsunami → overlay earthquakes & tsunami history → list nearby cities.</div>

    <div class="card">
      <label>Cloudflare Worker URL</label>
      <input id="workerUrl" type="text" value="https://ctrl-meteor.erickbm303.workers.dev" placeholder="https://&lt;your-worker&gt;.workers.dev" />
      <div class="muted">Must expose: <span class="pill">/simulate</span> <span class="pill">/story</span> <span class="pill">/save</span></div>
    </div>

    <div class="card">
      <label>Upload Data Files</label>
      <div class="dropzone">
        <div class="dz">
          <div class="muted">NEO (5 highlighted)</div>
          <input id="neoCsv" type="file" accept=".csv" />
        </div>
        <div class="dz">
          <div class="muted">Earthquakes</div>
          <input id="quakesCsv" type="file" accept=".csv" />
        </div>
        <div class="dz">
          <div class="muted">Tsunamis (B,C,D,O,P,Q)</div>
          <input id="tsunamiCsv" type="file" accept=".csv" />
        </div>
      </div>
      <div id="loadStatus" class="muted" style="margin-top:8px">No files loaded.</div>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <label>Select Meteor</label>
          <select id="meteorSelect"><option value="">— load NEO CSV —</option></select>
        </div>
        <div>
          <label>Impact Radius (km)</label>
          <input id="radiusKm" type="number" min="1" value="300" />
        </div>
      </div>
      <div class="row">
        <div>
          <label>Water Depth (m)</label>
          <input id="waterDepth" type="number" min="0" value="50" />
        </div>
        <div>
          <label>Deflection Δv (m/s)</label>
          <input id="deflection" type="number" min="0" value="0" />
        </div>
      </div>
      <div class="row">
        <div>
          <label>Density (kg/m³)</label>
          <input id="density" type="number" min="100" value="3000" />
        </div>
        <div class="stack" style="align-items:flex-end">
          <button id="simulateBtn" class="btn">Simulate</button>
          <button id="saveBtn" class="btn secondary">Save</button>
        </div>
      </div>
      <div class="legend" style="margin-top:10px">
        <span><span class="sw crater"></span>Crater radius</span>
        <span><span class="sw tsu"></span>Tsunami radius</span>
        <span><span class="sw quake"></span>Earthquakes</span>
        <span><span class="sw tsunamiEvt"></span>Tsunami events</span>
        <span><span class="sw city"></span>Cities</span>
        <span><span class="sw impact"></span>Impact point</span>
      </div>
    </div>

    <div class="card result" id="resultsBox">No simulation yet. Click map to set impact point, choose a meteor, then press <b>Simulate</b>.</div>
    <div class="card result" id="compareBox">No tsunami comparison yet.</div>

    <details class="card" open>
      <summary>Narrative</summary>
      <div id="storyBox" class="muted">—</div>
    </details>

    <details class="card">
      <summary>Earthquakes within radius</summary>
      <div id="quakeSummary" class="muted">—</div>
      <div id="quakeList" class="list"></div>
    </details>

    <details class="card">
      <summary>Tsunamis within radius</summary>
      <div id="tsuSummary" class="muted">—</div>
      <div id="tsuList" class="list"></div>
    </details>

    <details class="card">
      <summary>Cities impacted (≥2 per continent)</summary>
      <div id="citySummary" class="muted">—</div>
      <div id="cityList" class="list"></div>
    </details>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="script.js"></script>
</body>
</html>
